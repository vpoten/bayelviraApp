/*
 * KmpesDialog.java
 *
 * Created on 1 de febrero de 2001, 18:47
 */

package elvira.gui;

import java.awt.*;
import java.awt.event.*;
import java.util.Vector;
import javax.swing.*;
import java.text.DecimalFormat;
import elvira.inference.abduction.Explanation;
import elvira.Configuration;

/**
 *
 * @author  jgamez
 * @version 
 */
public class KmpesDialog extends javax.swing.JDialog {


    /**
     * A vector containing the KMPEs
     */

    Vector KMPEs;

    /**
     * The current index for KMPEs
     */

    int index;

    
    private static String imagesPath = "elvira/gui/images/";    

    /** Creates new form KmpesDialog */
    public KmpesDialog(//java.awt.Frame parent,boolean modal,
                       Vector v) {

        super ( ); //parent, modal);

        KMPEs = v;
        index = 0;

        initComponents ();
        pack ();
        setTitle("K Most Probable Explanations");
        setSize(500,420);
        setVisible(true);
        setModal(true);
    }

    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the FormEditor.
     */
    private void initComponents() {//GEN-BEGIN:initComponents
        jTextField1 = new javax.swing.JTextField();
        firstButton = new javax.swing.JButton();
        previousButton = new javax.swing.JButton();
        nextButton = new javax.swing.JButton();
        lastButton = new javax.swing.JButton();
        jLabel1 = new javax.swing.JLabel();
        jTextArea2 = new javax.swing.JTextArea( );
        jScrollPane1 = new javax.swing.JScrollPane( );
        okButton = new javax.swing.JButton();
        getContentPane().setLayout(null);
        
        
    
        jTextField1.setHorizontalAlignment(JTextField.CENTER);
        jTextField1.setText("jTextField1");
        
        getContentPane().add(jTextField1);
        jTextField1.setBounds(170, 50, 160, 30);
        printIndex();        
        
        
        firstButton.setIcon(new javax.swing.ImageIcon(imagesPath+"first.gif"));
        firstButton.setLabel(" ");
        
        getContentPane().add(firstButton);
        firstButton.setLocation(20, 50);
        firstButton.setSize(firstButton.getPreferredSize());
        
        previousButton.setIcon(new javax.swing.ImageIcon(imagesPath+"previous.gif"));
        previousButton.setLabel(" ");
        
        getContentPane().add(previousButton);
        previousButton.setLocation(90, 50);
        previousButton.setSize(previousButton.getPreferredSize());
        
        
        nextButton.setIcon(new javax.swing.ImageIcon(imagesPath+"next.gif"));
        nextButton.setLabel(" ");
        
        getContentPane().add(nextButton);
        nextButton.setLocation(350, 50);
        nextButton.setSize(nextButton.getPreferredSize());
        
        
        lastButton.setIcon(new javax.swing.ImageIcon(imagesPath+"last.gif"));
        lastButton.setSize(previousButton.getPreferredSize());
        
        getContentPane().add(lastButton);
        lastButton.setLocation(420,50);
        
        
        jLabel1.setText("(index) Probability");
        jLabel1.setBackground(java.awt.Color.white);
        jLabel1.setFont(new java.awt.Font ("Dialog", 1, 12));
        
        getContentPane().add(jLabel1);
        jLabel1.setBounds(180, 10, 160, 30);
        
        
        jScrollPane1.setBounds(80, 110, 330, 200);

        jTextArea2.setBounds(0, 0, 250, 90);
        jTextArea2.setEditable(false);
        jTextArea2.setWrapStyleWord(true);
        jTextArea2.setText("");
        jTextArea2.setLineWrap(true);

        jScrollPane1.setVerticalScrollBarPolicy(
              ScrollPaneConstants.VERTICAL_SCROLLBAR_ALWAYS);
        jScrollPane1.setHorizontalScrollBarPolicy(
              ScrollPaneConstants.HORIZONTAL_SCROLLBAR_ALWAYS);
        jScrollPane1.getViewport().add(jTextArea2);       
        jScrollPane1.setVisible(true);        

        getContentPane().add(jScrollPane1);

        

        printText();                
        
        

               

        
        okButton.setLabel("OK");
        okButton.setName("okButton");
        okButton.setFont(new java.awt.Font ("Dialog", 1, 12));
        okButton.setText("OK");
        
        getContentPane().add(okButton);
        okButton.setBounds(210, 340, 90, 40);

        //manejador de eventos
        OptionsAction opsAction = new OptionsAction();
        firstButton.addActionListener(opsAction);
        previousButton.addActionListener(opsAction);
        nextButton.addActionListener(opsAction);
        lastButton.addActionListener(opsAction);
        okButton.addActionListener(opsAction);        


    }//GEN-END:initComponents

    /**
    * @param args the command line arguments
    */
    public static void main (String args[]) {
        Vector v = new Vector();
        KmpesDialog kdialog;
        Explanation exp;
  
        for(int i=0;i<5;i++){
          exp = new Explanation(new Configuration(),1/(double)((i+1)*100)); 
          v.addElement(exp);
        }

        kdialog = new KmpesDialog (//new javax.swing.JFrame (), true, 
                                   v);
        kdialog.show ();
    }


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JTextField jTextField1;
    private javax.swing.JButton firstButton;
    private javax.swing.JButton previousButton;
    private javax.swing.JButton nextButton;
    private javax.swing.JButton lastButton;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JTextArea jTextArea2;
    //private javax.swing.JScrollBar jScrollBar3;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JButton okButton;
    // End of variables declaration//GEN-END:variables

    // Added to automatic code generation by Jose A. Gamez

    /**
     * Print index and probability in jTextField1
     */

    private void printIndex( ){
      DecimalFormat df = new DecimalFormat("0.000000");
      double d;

      d = ((Explanation)KMPEs.elementAt(index)).getProb();

      jTextField1.setFont(new Font("SansSerif",Font.BOLD,12));
      jTextField1.setText("("+(index+1)+") " + df.format(d));
      jTextField1.setEditable(false);
      jTextField1.repaint();
    }

    /**
     * Print explanation(index) in textArea
     */

    private void printText( ){
      String text="";

      text = "Explanation " + (index +1) + "\n\n";
      
      text = text + ((Explanation)KMPEs.elementAt(index)).toString();

      jTextArea2.setFont(new Font("SansSerif",Font.BOLD,12));
      jTextArea2.setText(text);
      jTextArea2.setEditable(false);
      jTextArea2.repaint();
    }

    // Handle events
 
    class OptionsAction implements ActionListener{

      public void actionPerformed(java.awt.event.ActionEvent event){

         Object object = event.getSource();
                        
         if (object == okButton)
               okButton_actionPerformed(event);
         else if (object == firstButton)
               firstButton_actionPerformed(event);
         else if (object == previousButton)
               previousButton_actionPerformed(event);
         else if (object == nextButton)
               nextButton_actionPerformed(event);
         else if (object == lastButton)
               lastButton_actionPerformed(event);
 
      } // end of constructor   
      
      void okButton_actionPerformed(java.awt.event.ActionEvent event){
        setVisible (false);
        dispose ();
      }     

      void firstButton_actionPerformed(java.awt.event.ActionEvent event){
        index = 0;
        printIndex();
        printText();
      }     

      void nextButton_actionPerformed(java.awt.event.ActionEvent event){
        if (index != (KMPEs.size()-1)){
          index++;
          printIndex();
          printText();
        }
      }     
     
      void previousButton_actionPerformed(java.awt.event.ActionEvent event){
        if (index != 0){
          index--;
          printIndex();
          printText();
        }
      }     

      void lastButton_actionPerformed(java.awt.event.ActionEvent event){
        index = KMPEs.size()-1;
        printIndex();
        printText();
      }     




    } // end of class OptionsAction

}


